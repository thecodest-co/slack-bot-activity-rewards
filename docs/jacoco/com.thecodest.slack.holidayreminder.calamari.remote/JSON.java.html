<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSON.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">holiday-reminder</a> &gt; <a href="index.source.html" class="el_package">com.thecodest.slack.activityrewards.calamari.remote</a> &gt; <span class="el_source">JSON.java</span></div><h1>JSON.java</h1><pre class="source lang-java linenums">/*
 * Calamari API
 * No description provided (generated by Swagger Codegen https://github.com/swagger-api/swagger-codegen)
 *
 * OpenAPI spec version: 1
 * Contact: developers@calamari.io
 *
 * NOTE: This class is auto generated by the swagger code generator program.
 * https://github.com/swagger-api/swagger-codegen.git
 * Do not edit the class manually.
 */

package com.thecodest.slack.holidayreminder.calamari.remote;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.JsonElement;
import com.google.gson.JsonParseException;
import com.google.gson.TypeAdapter;
import com.google.gson.internal.bind.util.ISO8601Utils;
import com.google.gson.stream.JsonReader;
import com.google.gson.stream.JsonToken;
import com.google.gson.stream.JsonWriter;
import io.gsonfire.GsonFireBuilder;
import java.io.IOException;
import java.io.StringReader;
import java.lang.reflect.Type;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.ParsePosition;
import java.time.LocalDate;
import java.time.OffsetDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Date;
import java.util.Map;

public class JSON {
<span class="fc" id="L38">	private final DateTypeAdapter dateTypeAdapter = new DateTypeAdapter();</span>
<span class="fc" id="L39">	private final SqlDateTypeAdapter sqlDateTypeAdapter = new SqlDateTypeAdapter();</span>
<span class="fc" id="L40">	private final OffsetDateTimeTypeAdapter offsetDateTimeTypeAdapter = new OffsetDateTimeTypeAdapter();</span>
<span class="fc" id="L41">	private final LocalDateTypeAdapter localDateTypeAdapter = new LocalDateTypeAdapter();</span>
	private Gson gson;
<span class="fc" id="L43">	private boolean isLenientOnJson = false;</span>

<span class="fc" id="L45">	public JSON() {</span>
<span class="fc" id="L46">		gson = createGson().registerTypeAdapter(Date.class, dateTypeAdapter).registerTypeAdapter(java.sql.Date.class, sqlDateTypeAdapter).registerTypeAdapter(OffsetDateTime.class, offsetDateTimeTypeAdapter).registerTypeAdapter(LocalDate.class, localDateTypeAdapter).create();</span>
<span class="fc" id="L47">	}</span>

	public static GsonBuilder createGson() {
<span class="fc" id="L50">		GsonFireBuilder fireBuilder = new GsonFireBuilder();</span>
<span class="fc" id="L51">		return fireBuilder.createGsonBuilder();</span>
	}

	private static String getDiscriminatorValue(JsonElement readElement, String discriminatorField) {
<span class="nc" id="L55">		JsonElement element = readElement.getAsJsonObject().get(discriminatorField);</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">		if(null == element) {</span>
<span class="nc" id="L57">			throw new IllegalArgumentException(&quot;missing discriminator field: &lt;&quot; + discriminatorField + &quot;&gt;&quot;);</span>
		}
<span class="nc" id="L59">		return element.getAsString();</span>
	}

	private static &lt;T&gt; Class&lt;? extends T&gt; getClassByDiscriminator(Map&lt;String, Class&lt;? extends T&gt;&gt; classByDiscriminatorValue, String discriminatorValue) {
<span class="nc" id="L63">		Class&lt;? extends T&gt; clazz = classByDiscriminatorValue.get(discriminatorValue.toUpperCase());</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">		if(null == clazz) {</span>
<span class="nc" id="L65">			throw new IllegalArgumentException(&quot;cannot determine model class of name: &lt;&quot; + discriminatorValue + &quot;&gt;&quot;);</span>
		}
<span class="nc" id="L67">		return clazz;</span>
	}

	/**
	 * Get Gson.
	 *
	 * @return Gson
	 */
	public Gson getGson() {
<span class="nc" id="L76">		return gson;</span>
	}

	/**
	 * Set Gson.
	 *
	 * @param gson Gson
	 * @return JSON
	 */
	public JSON setGson(Gson gson) {
<span class="nc" id="L86">		this.gson = gson;</span>
<span class="nc" id="L87">		return this;</span>
	}

	public JSON setLenientOnJson(boolean lenientOnJson) {
<span class="nc" id="L91">		isLenientOnJson = lenientOnJson;</span>
<span class="nc" id="L92">		return this;</span>
	}

	/**
	 * Serialize the given Java object into JSON string.
	 *
	 * @param obj Object
	 * @return String representation of the JSON
	 */
	public String serialize(Object obj) {
<span class="nc" id="L102">		return gson.toJson(obj);</span>
	}

	/**
	 * Deserialize the given JSON string to Java object.
	 *
	 * @param &lt;T&gt;        Type
	 * @param body       The JSON string
	 * @param returnType The type to deserialize into
	 * @return The deserialized Java object
	 */
	@SuppressWarnings(&quot;unchecked&quot;)
	public &lt;T&gt; T deserialize(String body, Type returnType) {
		try {
<span class="nc bnc" id="L116" title="All 2 branches missed.">			if(isLenientOnJson) {</span>
<span class="nc" id="L117">				JsonReader jsonReader = new JsonReader(new StringReader(body));</span>
				// see https://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/stream/JsonReader.html#setLenient(boolean)
<span class="nc" id="L119">				jsonReader.setLenient(true);</span>
<span class="nc" id="L120">				return gson.fromJson(jsonReader, returnType);</span>
			} else {
<span class="nc" id="L122">				return gson.fromJson(body, returnType);</span>
			}
<span class="nc" id="L124">		} catch(JsonParseException e) {</span>
			// Fallback processing when failed to parse JSON form response body:
			// return the response body string directly for the String return type;
<span class="nc bnc" id="L127" title="All 2 branches missed.">			if(returnType.equals(String.class))</span>
<span class="nc" id="L128">				return (T) body;</span>
			else
<span class="nc" id="L130">				throw (e);</span>
		}
	}

	public JSON setOffsetDateTimeFormat(DateTimeFormatter dateFormat) {
<span class="nc" id="L135">		offsetDateTimeTypeAdapter.setFormat(dateFormat);</span>
<span class="nc" id="L136">		return this;</span>
	}

	public JSON setLocalDateFormat(DateTimeFormatter dateFormat) {
<span class="nc" id="L140">		localDateTypeAdapter.setFormat(dateFormat);</span>
<span class="nc" id="L141">		return this;</span>
	}

	public JSON setDateFormat(DateFormat dateFormat) {
<span class="nc" id="L145">		dateTypeAdapter.setFormat(dateFormat);</span>
<span class="nc" id="L146">		return this;</span>
	}

	public JSON setSqlDateFormat(DateFormat dateFormat) {
<span class="nc" id="L150">		sqlDateTypeAdapter.setFormat(dateFormat);</span>
<span class="nc" id="L151">		return this;</span>
	}

	/**
	 * Gson TypeAdapter for JSR310 OffsetDateTime type
	 */
	public static class OffsetDateTimeTypeAdapter extends TypeAdapter&lt;OffsetDateTime&gt; {

		private DateTimeFormatter formatter;

		public OffsetDateTimeTypeAdapter() {
<span class="fc" id="L162">			this(DateTimeFormatter.ISO_OFFSET_DATE_TIME);</span>
<span class="fc" id="L163">		}</span>

<span class="fc" id="L165">		public OffsetDateTimeTypeAdapter(DateTimeFormatter formatter) {</span>
<span class="fc" id="L166">			this.formatter = formatter;</span>
<span class="fc" id="L167">		}</span>

		public void setFormat(DateTimeFormatter dateFormat) {
<span class="nc" id="L170">			this.formatter = dateFormat;</span>
<span class="nc" id="L171">		}</span>

		@Override
		public void write(JsonWriter out, OffsetDateTime date) throws IOException {
<span class="nc bnc" id="L175" title="All 2 branches missed.">			if(date == null) {</span>
<span class="nc" id="L176">				out.nullValue();</span>
			} else {
<span class="nc" id="L178">				out.value(formatter.format(date));</span>
			}
<span class="nc" id="L180">		}</span>

		@Override
		public OffsetDateTime read(JsonReader in) throws IOException {
<span class="nc bnc" id="L184" title="All 2 branches missed.">			if(in.peek() == JsonToken.NULL) {</span>
<span class="nc" id="L185">				in.nextNull();</span>
<span class="nc" id="L186">				return null;</span>
			}
<span class="nc" id="L188">			String date = in.nextString();</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">			if(date.endsWith(&quot;+0000&quot;)) {</span>
<span class="nc" id="L190">				date = date.substring(0, date.length() - 5) + &quot;Z&quot;;</span>
			}
<span class="nc" id="L192">			return OffsetDateTime.parse(date, formatter);</span>
		}
	}

	/**
	 * Gson TypeAdapter for java.sql.Date type
	 * If the dateFormat is null, a simple &quot;yyyy-MM-dd&quot; format will be used
	 * (more efficient than SimpleDateFormat).
	 */
	public static class SqlDateTypeAdapter extends TypeAdapter&lt;java.sql.Date&gt; {

		private DateFormat dateFormat;

<span class="fc" id="L205">		public SqlDateTypeAdapter() {</span>
<span class="fc" id="L206">		}</span>

<span class="nc" id="L208">		public SqlDateTypeAdapter(DateFormat dateFormat) {</span>
<span class="nc" id="L209">			this.dateFormat = dateFormat;</span>
<span class="nc" id="L210">		}</span>

		public void setFormat(DateFormat dateFormat) {
<span class="nc" id="L213">			this.dateFormat = dateFormat;</span>
<span class="nc" id="L214">		}</span>

		@Override
		public void write(JsonWriter out, java.sql.Date date) throws IOException {
<span class="nc bnc" id="L218" title="All 2 branches missed.">			if(date == null) {</span>
<span class="nc" id="L219">				out.nullValue();</span>
			} else {
				String value;
<span class="nc bnc" id="L222" title="All 2 branches missed.">				if(dateFormat != null) {</span>
<span class="nc" id="L223">					value = dateFormat.format(date);</span>
				} else {
<span class="nc" id="L225">					value = date.toString();</span>
				}
<span class="nc" id="L227">				out.value(value);</span>
			}
<span class="nc" id="L229">		}</span>

		@Override
		public java.sql.Date read(JsonReader in) throws IOException {
<span class="nc bnc" id="L233" title="All 2 branches missed.">			if(in.peek() == JsonToken.NULL) {</span>
<span class="nc" id="L234">				in.nextNull();</span>
<span class="nc" id="L235">				return null;</span>
			}
<span class="nc" id="L237">			String date = in.nextString();</span>
			try {
<span class="nc bnc" id="L239" title="All 2 branches missed.">				if(dateFormat != null) {</span>
<span class="nc" id="L240">					return new java.sql.Date(dateFormat.parse(date).getTime());</span>
				}
<span class="nc" id="L242">				return new java.sql.Date(ISO8601Utils.parse(date, new ParsePosition(0)).getTime());</span>
<span class="nc" id="L243">			} catch(ParseException e) {</span>
<span class="nc" id="L244">				throw new JsonParseException(e);</span>
			}
		}
	}

	/**
	 * Gson TypeAdapter for java.util.Date type
	 * If the dateFormat is null, ISO8601Utils will be used.
	 */
	public static class DateTypeAdapter extends TypeAdapter&lt;Date&gt; {

		private DateFormat dateFormat;

<span class="fc" id="L257">		public DateTypeAdapter() {</span>
<span class="fc" id="L258">		}</span>

<span class="nc" id="L260">		public DateTypeAdapter(DateFormat dateFormat) {</span>
<span class="nc" id="L261">			this.dateFormat = dateFormat;</span>
<span class="nc" id="L262">		}</span>

		public void setFormat(DateFormat dateFormat) {
<span class="nc" id="L265">			this.dateFormat = dateFormat;</span>
<span class="nc" id="L266">		}</span>

		@Override
		public void write(JsonWriter out, Date date) throws IOException {
<span class="nc bnc" id="L270" title="All 2 branches missed.">			if(date == null) {</span>
<span class="nc" id="L271">				out.nullValue();</span>
			} else {
				String value;
<span class="nc bnc" id="L274" title="All 2 branches missed.">				if(dateFormat != null) {</span>
<span class="nc" id="L275">					value = dateFormat.format(date);</span>
				} else {
<span class="nc" id="L277">					value = ISO8601Utils.format(date, true);</span>
				}
<span class="nc" id="L279">				out.value(value);</span>
			}
<span class="nc" id="L281">		}</span>

		@Override
		public Date read(JsonReader in) throws IOException {
			try {
<span class="nc bnc" id="L286" title="All 2 branches missed.">				if(in.peek() == JsonToken.NULL) {</span>
<span class="nc" id="L287">					in.nextNull();</span>
<span class="nc" id="L288">					return null;</span>
				}
<span class="nc" id="L290">				String date = in.nextString();</span>
				try {
<span class="nc bnc" id="L292" title="All 2 branches missed.">					if(dateFormat != null) {</span>
<span class="nc" id="L293">						return dateFormat.parse(date);</span>
					}
<span class="nc" id="L295">					return ISO8601Utils.parse(date, new ParsePosition(0));</span>
<span class="nc" id="L296">				} catch(ParseException e) {</span>
<span class="nc" id="L297">					throw new JsonParseException(e);</span>
				}
<span class="nc" id="L299">			} catch(IllegalArgumentException e) {</span>
<span class="nc" id="L300">				throw new JsonParseException(e);</span>
			}
		}
	}

	/**
	 * Gson TypeAdapter for JSR310 LocalDate type
	 */
	public class LocalDateTypeAdapter extends TypeAdapter&lt;LocalDate&gt; {

		private DateTimeFormatter formatter;

		public LocalDateTypeAdapter() {
<span class="fc" id="L313">			this(DateTimeFormatter.ISO_LOCAL_DATE);</span>
<span class="fc" id="L314">		}</span>

<span class="fc" id="L316">		public LocalDateTypeAdapter(DateTimeFormatter formatter) {</span>
<span class="fc" id="L317">			this.formatter = formatter;</span>
<span class="fc" id="L318">		}</span>

		public void setFormat(DateTimeFormatter dateFormat) {
<span class="nc" id="L321">			this.formatter = dateFormat;</span>
<span class="nc" id="L322">		}</span>

		@Override
		public void write(JsonWriter out, LocalDate date) throws IOException {
<span class="nc bnc" id="L326" title="All 2 branches missed.">			if(date == null) {</span>
<span class="nc" id="L327">				out.nullValue();</span>
			} else {
<span class="nc" id="L329">				out.value(formatter.format(date));</span>
			}
<span class="nc" id="L331">		}</span>

		@Override
		public LocalDate read(JsonReader in) throws IOException {
<span class="nc bnc" id="L335" title="All 2 branches missed.">			if(in.peek() == JsonToken.NULL) {</span>
<span class="nc" id="L336">				in.nextNull();</span>
<span class="nc" id="L337">				return null;</span>
			}
<span class="nc" id="L339">			String date = in.nextString();</span>
<span class="nc" id="L340">			return LocalDate.parse(date, formatter);</span>
		}
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>